services:
  - type: web
    name: family-tree-app
    env: python
    buildCommand: pip install -r requirements.txt
    startCommand: gunicorn family_tree.wsgi:app --bind 0.0.0.0:8000
    staticAssets:
      - path: /static
        destination: static
    plan: free
    envVars:
      - key: DATABASE_URL
        value: sqlite:///family.db

    releaseCommand: |
      flask shell -c "from family_tree.create_persons import create_persons_table; create_persons_table()"
      flask shell -c "from family_tree.insertion import full_initialize; full_initialize()"
      flask shell -c "from family_tree.fix_names import fix_names; fix_names()"
